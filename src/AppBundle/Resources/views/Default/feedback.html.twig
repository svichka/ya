{% extends 'AppBundle:Default:base.html.twig' %}

{% trans_default_domain "feedback" %}

{% block title %}
  Обратная связь
{% endblock %}

{% block body %}
  <main class="main" id="main">
    <div class="main__content main__content_dis_flex">
      <div class="main__left">
        <h1 class="title title_align_left">Обратная связь</h1>
        {% form_theme form 'AppBundle:Forms:form_div_layout.html.twig' %}
        {{ form_start(form) }}
        <div class="form__wrapper">
          <div class="form__row">
            <div class="form__box">
              {% if errors %}
                {% for error in errors %}
                  <label class="form__label" style="color: red;">
                    {{ error }}
                  </label>
                {% endfor %}
              {% endif %}
              <label class="form__label" for="email">Ваш e-mail</label>
              {{ form_widget(form.email) }}
            </div>
          </div>
          <div class="form__row">
            <div class="form__box">
              <label class="form__label" for="theme">Тема сообщения</label>
              {{ form_widget(form.theme_id) }}
            </div>
          </div>
          <div class="form__row">
            <div class="form__box">
              <label class="form__label" for="theme">ТЕКСТ СООБЩЕНИЯ</label>
              {{ form_widget(form.message) }}
            </div>
          </div>
          <div class="form__row">
            <div class="form__box">
              <label class="form__label form__label_type_file" for="file">
                {{ form_widget(form.file, { 'id': 'file'}) }}
                <span class="form__load-file-title">Прикрепите файл</span>
              </label>
            </div>
          </div>
          <div class="form__row">
            {{ form_row(form.recaptcha) }}
            {{ form_row(form.agree) }}
          </div>
          <div class="form__row">
            <div class="form__box form__box_button-faq">
              <button class="button faqSubmit" type="submit">
                <span class="button__text">Отправить</span></button>
            </div>
          </div>
        </div>
        {{ form_end(form) }}
      </div>
    </div>
  </main>
{% endblock %}

{% block javascripts %}
  {{ parent() }}
  <script>


    function showError() {
      $('.free-text-h').html('Обратная связь');
      $('.free-text').html('Ошибка отправки данных.');
      $('#freeModal').arcticmodal(favSyr.popup.options);
    }

    document.addEventListener('feedback_error', function (e) {
      showError()
    }, false);

    function ValidateSize(file) {
      var FileSize = file.files[ 0 ].size / 1024 / 1024; // in MB
      if (FileSize > 3) {
        $('.free-text-h').html('Обратная связь');
        $('.free-text').html('Превышен допустимый размер файла в 3 Мб.<br>' +
          ' Попробуйте загрузить файл другого размера.');
        $('#freeModal').arcticmodal(favSyr.popup.options);
        $(file).val(''); //for clearing with Jquery
      } else {

      }
    }

  </script>
{% endblock %}

{% block modals %}
  {{ parent() }}
{% endblock %}